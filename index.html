<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìš°ë¦¬ ê°€ì¡± í€´ì¦ˆ</title>
    <link href="https://fonts.googleapis.com/css2?family=Jua&family=Nanum+Pen+Script&family=Gothic+A1:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* ê¸°ë³¸ CSS ì´ˆê¸°í™” ë° ì „ì—­ ìŠ¤íƒ€ì¼ */
        body {
            margin: 0;
            padding: 0;
            font-family: 'Jua', sans-serif; /* ê¸°ë³¸ í°íŠ¸ ì„¤ì • */
            background: linear-gradient(135deg, #ADD8E6, #98FB98); /* ì—°íŒŒë‘, ì—°ë‘ìƒ‰ ê·¸ë¼ë°ì´ì…˜ ë°°ê²½ */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh; /* ë·°í¬íŠ¸ ë†’ì´ ì „ì²´ ì‚¬ìš© */
            color: #333333; /* ê¸°ë³¸ í…ìŠ¤íŠ¸ ìƒ‰ìƒ */
            /* overflow: hidden; /* ìŠ¤í¬ë¡¤ ë¬¸ì œ í•´ê²°ì„ ìœ„í•´ ì´ ì†ì„± ì œê±° */
        }

        #app-container {
            background-color: rgba(255, 255, 255, 0.9); /* ë°˜íˆ¬ëª… í°ìƒ‰ ë°°ê²½ */
            border-radius: 25px; /* ë‘¥ê·¼ ëª¨ì„œë¦¬ */
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2); /* ê·¸ë¦¼ì íš¨ê³¼ */
            padding: 30px;
            width: 90%; /* ëª¨ë°”ì¼ í™”ë©´ì— ë§ê²Œ ë„ˆë¹„ ì¡°ì • */
            max-width: 800px; /* ìµœëŒ€ ë„ˆë¹„ ì„¤ì • */
            text-align: center;
            box-sizing: border-box; /* íŒ¨ë”© í¬í•¨ ë„ˆë¹„ ê³„ì‚° */
            position: relative; /* ì• ë‹ˆë©”ì´ì…˜ ì»¨í…Œì´ë„ˆ ê¸°ì¤€ */
            /* ìŠ¤í¬ë¡¤ ë¬¸ì œ í•´ê²°: ì»¨í…Œì´ë„ˆ ë‚´ë¶€ ìŠ¤í¬ë¡¤ í—ˆìš© */
            max-height: calc(100vh - 60px); /* ë·°í¬íŠ¸ ë†’ì´ì—ì„œ ìƒí•˜ ì—¬ë°± 30px*2=60px ì œì™¸ */
            overflow-y: auto; /* ë‚´ìš©ì´ ë„˜ì¹  ê²½ìš° ì„¸ë¡œ ìŠ¤í¬ë¡¤ë°” í‘œì‹œ */
            -webkit-overflow-scrolling: touch; /* iOSì—ì„œ ë¶€ë“œëŸ¬ìš´ ìŠ¤í¬ë¡¤ */
        }

        .game-screen {
            display: flex;
            flex-direction: column;
            gap: 20px;
            transition: opacity 0.5s ease-in-out, transform 0.5s ease-in-out; /* í™”ë©´ ì „í™˜ ì• ë‹ˆë©”ì´ì…˜ */
            opacity: 1;
            transform: translateY(0);
        }

        .game-screen.hidden {
            opacity: 0;
            transform: translateY(20px);
            position: absolute; /* ìˆ¨ê²¨ì§„ í™”ë©´ì€ ê³µê°„ì„ ì°¨ì§€í•˜ì§€ ì•Šë„ë¡ */
            top: 30px; /* app-containerì˜ íŒ¨ë”©ê³¼ ë™ì¼í•˜ê²Œ ì„¤ì • */
            left: 30px;
            right: 30px;
            pointer-events: none; /* ìˆ¨ê²¨ì§„ í™”ë©´ì˜ ì´ë²¤íŠ¸ ë¹„í™œì„±í™” */
        }

        h1, h2 {
            font-family: 'Jua', sans-serif;
            color: #333333;
            margin-bottom: 20px;
        }

        h1 {
            font-size: 2.5em; /* ì œëª© í¬ê¸° */
            color: #4CAF50; /* ê°•ì¡° ìƒ‰ìƒ */
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        h2 {
            font-size: 1.8em;
            color: #3F51B5;
        }

        p {
            font-family: 'Gothic A1', sans-serif;
            font-size: 1.1em;
            line-height: 1.6;
        }

        /* ì…ë ¥ í•„ë“œ ë° ë“œë¡­ë‹¤ìš´ ìŠ¤íƒ€ì¼ */
        textarea, input[type="text"], select {
            width: calc(100% - 20px); /* íŒ¨ë”© ê³ ë ¤ */
            padding: 12px;
            margin-bottom: 15px;
            border: 2px solid #B2EBF2; /* ì—°í•œ í…Œë‘ë¦¬ */
            border-radius: 12px; /* ë‘¥ê·¼ ëª¨ì„œë¦¬ */
            font-size: 1.1em;
            font-family: 'Gothic A1', sans-serif;
            box-sizing: border-box;
            outline: none; /* í¬ì»¤ìŠ¤ ì‹œ ì•„ì›ƒë¼ì¸ ì œê±° */
            transition: border-color 0.3s ease;
        }

        textarea:focus, input[type="text"]:focus, select:focus {
            border-color: #4CAF50; /* í¬ì»¤ìŠ¤ ì‹œ ê°•ì¡° ìƒ‰ìƒ */
        }

        textarea {
            min-height: 100px;
            resize: vertical; /* ì„¸ë¡œ í¬ê¸° ì¡°ì ˆ ê°€ëŠ¥ */
        }

        /* ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .cute-button {
            background-color: #FFC107; /* í™œê¸°ì°¬ íŒŒìŠ¤í…”í†¤ ë…¸ë€ìƒ‰ */
            color: white;
            padding: 15px 25px;
            border: none;
            border-radius: 15px; /* ë‘¥ê·¼ ëª¨ì„œë¦¬ */
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease;
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.15); /* ê·¸ë¦¼ì íš¨ê³¼ */
            display: inline-block; /* í…ìŠ¤íŠ¸ í¬ê¸°ì— ë§ê²Œ ë„ˆë¹„ ì¡°ì ˆ */
            margin: 5px;
        }

        .cute-button:hover {
            background-color: #FFA000; /* í˜¸ë²„ ì‹œ ë” ì§„í•œ ìƒ‰ìƒ */
            transform: translateY(-3px); /* ì‚´ì§ ìœ„ë¡œ ì˜¬ë¼ì˜¤ëŠ” íš¨ê³¼ */
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2);
        }

        .cute-button:active {
            transform: translateY(0); /* í´ë¦­ ì‹œ ì›ìœ„ì¹˜ */
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.1);
        }

        /* íŠ¹ì • ë²„íŠ¼ ìƒ‰ìƒ */
        #start-game-btn { background-color: #4CAF50; } /* ì´ˆë¡ìƒ‰ */
        #start-game-btn:hover { background-color: #388E3C; }
        #load-text-csv-btn, #load-url-csv-btn { background-color: #607D8B; } /* íšŒìƒ‰ í†¤ */
        #load-text-csv-btn:hover, #load-url-csv-btn:hover { background-color: #455A64; }

        /* 4ì§€ì„ ë‹¤ ì„ íƒì§€ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .answer-options-container {
            display: grid; /* ê·¸ë¦¬ë“œ ë ˆì´ì•„ì›ƒ ì‚¬ìš© */
            grid-template-columns: 1fr 1fr; /* ë‘ ê°œì˜ ì—´ë¡œ ë‚˜ëˆ” */
            gap: 15px; /* ë²„íŠ¼ ê°„ ê°„ê²© */
            margin-top: 20px;
            margin-bottom: 20px;
        }

        .answer-option-button {
            background-color: #90CAF9; /* ì—°í•œ íŒŒë€ìƒ‰ */
            color: #333333;
            padding: 15px;
            border: 2px solid #64B5F6;
            border-radius: 15px;
            font-size: 1.1em;
            font-family: 'Gothic A1', sans-serif;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            word-break: keep-all; /* ë‹¨ì–´ ë‹¨ìœ„ ì¤„ë°”ê¿ˆ */
        }

        .answer-option-button:hover {
            background-color: #42A5F5; /* í˜¸ë²„ ì‹œ ë” ì§„í•œ íŒŒë€ìƒ‰ */
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }

        .answer-option-button:active {
            transform: translateY(0);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .answer-option-button.correct {
            background-color: #81C784; /* ì •ë‹µ ì‹œ ì—°í•œ ì´ˆë¡ìƒ‰ */
            border-color: #4CAF50;
        }
        .answer-option-button.incorrect {
            background-color: #E57373; /* ì˜¤ë‹µ ì‹œ ì—°í•œ ë¹¨ê°„ìƒ‰ */
            border-color: #F44336;
        }
        .answer-option-button.disabled {
            pointer-events: none; /* í´ë¦­ ë¹„í™œì„±í™” */
            opacity: 0.7;
        }


        #check-answer-btn { background-color: #2196F3; } /* íŒŒë€ìƒ‰ */
        #check-answer-btn:hover { background-color: #1976D2; }

        #next-question-btn { background-color: #FF9800; } /* ì£¼í™©ìƒ‰ */
        #next-question-btn:hover { background-color: #FB8C00; }

        #restart-game-btn { background-color: #F44336; } /* ë¹¨ê°„ìƒ‰ */
        #restart-game-btn:hover { background-color: #D32F2F; }

        /* ì§„í–‰ ìƒíƒœ í‘œì‹œ */
        #progress-display {
            font-size: 1.2em;
            font-weight: bold;
            color: #607D8B; /* íšŒìƒ‰ í†¤ */
            margin-bottom: 20px;
            background-color: #E0F2F7;
            padding: 10px;
            border-radius: 10px;
        }

        /* í”¼ë“œë°± ë©”ì‹œì§€ ì˜ì—­ */
        #feedback-message {
            min-height: 50px; /* ë©”ì‹œì§€ê°€ ì—†ì–´ë„ ê³µê°„ ìœ ì§€ */
            font-size: 1.3em;
            font-weight: bold;
            margin-top: 15px;
            margin-bottom: 15px;
            transition: color 0.3s ease, transform 0.3s ease;
        }

        .correct-feedback {
            color: #4CAF50; /* ì´ˆë¡ìƒ‰ */
            animation: bounceIn 0.8s ease-out; /* ì •ë‹µ ì• ë‹ˆë©”ì´ì…˜ */
        }

        .incorrect-feedback {
            color: #F44336; /* ë¹¨ê°„ìƒ‰ */
            animation: shake 0.5s ease-out; /* ì˜¤ë‹µ ì• ë‹ˆë©”ì´ì…˜ */
        }

        /* ì˜¤ë‹µ ì‹œ ì„¤ëª… */
        #explanation-text {
            font-size: 1.1em;
            color: #795548; /* ê°ˆìƒ‰ í†¤ */
            margin-top: 10px; /* ìœ„ìª½ ì—¬ë°± ì¡°ì • */
            margin-bottom: 15px;
            font-family: 'Nanum Pen Script', cursive;
            font-weight: bold;
            opacity: 0.7; /* ë°˜íˆ¬ëª… íš¨ê³¼ */
        }

        /* ê²°ê³¼ í™”ë©´ ìŠ¤íƒ€ì¼ */
        #result-screen h2 {
            color: #3F51B5;
            font-size: 2em;
        }

        #score-display, #high-score-display {
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 10px;
            color: #673AB7; /* ë³´ë¼ìƒ‰ í†¤ */
        }

        /* ì• ë‹ˆë©”ì´ì…˜ ì»¨í…Œì´ë„ˆ */
        #animation-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none; /* í´ë¦­ ì´ë²¤íŠ¸ ë°©ì§€ */
            overflow: hidden; /* ì»¨í…Œì´ë„ˆ ë°–ìœ¼ë¡œ ë‚˜ê°€ëŠ” íŒŒí‹°í´ ìˆ¨ê¹€ */
        }

        /* íŒŒí‹°í´ ì• ë‹ˆë©”ì´ì…˜ (í­ì£½/ë°˜ì§ì´) */
        .particle {
            position: absolute;
            background-color: white;
            border-radius: 50%;
            opacity: 0;
            animation: particle-fade-out 1s forwards;
        }

        /* í‚¤í”„ë ˆì„ ì• ë‹ˆë©”ì´ì…˜ */
        @keyframes bounceIn {
            0% { opacity: 0; transform: scale(0.3); }
            50% { opacity: 1; transform: scale(1.1); }
            70% { transform: scale(0.9); }
            100% { transform: scale(1); }
        }

        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            50% { transform: translateX(5px); }
            75% { transform: translateX(-5px); }
            100% { transform: translateX(0); }
        }

        @keyframes fadeInOut {
            0% { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
            20% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
            80% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
            100% { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
        }

        @keyframes particle-fade-out {
            0% { opacity: 1; transform: scale(0.5); }
            100% { opacity: 0; transform: scale(1.5); }
        }

        /* ëª¨ë°”ì¼ ë°˜ì‘í˜• ë””ìì¸ */
        @media (max-width: 600px) {
            #app-container {
                padding: 20px;
                border-radius: 15px;
                width: 95%; /* ë” ì‘ì€ í™”ë©´ì— ë§ê²Œ ë„ˆë¹„ ì¡°ì • */
                /* ëª¨ë°”ì¼ì—ì„œ ë†’ì´ê°€ ì§§ì„ ê²½ìš°ë¥¼ ëŒ€ë¹„í•˜ì—¬ max-height ì¡°ì • */
                max-height: calc(100vh - 40px); /* ìƒí•˜ ì—¬ë°± 20px*2=40px ì œì™¸ */
            }

            h1 {
                font-size: 2em;
            }

            h2 {
                font-size: 1.5em;
            }

            .cute-button {
                padding: 12px 20px;
                font-size: 1.1em;
            }

            textarea, input[type="text"], select {
                padding: 10px;
                font-size: 1em;
            }

            #feedback-message {
                font-size: 1.1em;
            }

            .answer-options-container {
                grid-template-columns: 1fr; /* ëª¨ë°”ì¼ì—ì„œëŠ” í•œ ì—´ë¡œ í‘œì‹œ */
            }
        }
    </style>
</head>
<body>
    <div id="app-container">
        <div id="start-screen" class="game-screen">
            <h1>âœ¨ ìš°ë¦¬ ê°€ì¡± í€´ì¦ˆ ê²Œì„ âœ¨</h1>
            <p>CSV í˜•ì‹ì˜ í€´ì¦ˆ ë°ì´í„°ë¥¼ ì•„ë˜ì— ì§ì ‘ ë¶™ì—¬ë„£ê±°ë‚˜, Google ìŠ¤í”„ë ˆë“œì‹œíŠ¸ì˜ ê³µê°œ CSV URLì„ ì…ë ¥í•˜ì„¸ìš”.</p>

            <label for="csv-text-input" style="font-weight: bold; margin-bottom: 5px; display: block;">CSV í…ìŠ¤íŠ¸ ì§ì ‘ ë¶™ì—¬ë„£ê¸°:</label>
            <textarea id="csv-text-input" placeholder="ì—¬ê¸°ì— CSV í€´ì¦ˆ ë°ì´í„°ë¥¼ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”. (ì˜ˆ: ê°€ì¡±ìƒì‹,ì•„ë¹ ì˜ ë³„ëª…ì€?,ìŠˆí¼ë§¨,ë°°íŠ¸ë§¨,ìŠ¤íŒŒì´ë”ë§¨,ì•„ì´ì–¸ë§¨,ì•„ë¹ ëŠ” ì •ë§ ë©‹ì§„ ì˜ì›…ì´ì…”!)"></textarea>
            <button id="load-text-csv-btn" class="cute-button">í…ìŠ¤íŠ¸ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°</button>

            <p style="margin-top: 20px; margin-bottom: 10px; font-weight: bold;">ë˜ëŠ” Google ìŠ¤í”„ë ˆë“œì‹œíŠ¸ URLë¡œ ë¶ˆëŸ¬ì˜¤ê¸°:</p>
            <p style="font-size: 0.9em; color: #666;">(ìŠ¤í”„ë ˆë“œì‹œíŠ¸ì—ì„œ 'íŒŒì¼ > ê³µìœ  > ì›¹ì— ê²Œì‹œ > ì‰¼í‘œë¡œ êµ¬ë¶„ëœ ê°’(.csv)'ìœ¼ë¡œ ê²Œì‹œí•œ í›„ URLì„ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”.)</p>
            <input type="text" id="csv-url-input" placeholder="Google ìŠ¤í”„ë ˆë“œì‹œíŠ¸ ê³µê°œ CSV URL">
            <button id="load-url-csv-btn" class="cute-button">URL ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°</button>
            <div id="loading-indicator" style="display: none; margin-top: 10px; font-weight: bold; color: #2196F3;">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>

            <p style="margin-top: 20px;">í€´ì¦ˆ ì¢…ëª©ì„ ì„ íƒí•˜ê³  ê²Œì„ì„ ì‹œì‘í•˜ì„¸ìš”:</p>
            <select id="category-select">
                <option value="">-- ì¢…ëª© ì„ íƒ --</option>
            </select>
            <button id="start-game-btn" class="cute-button">ê²Œì„ ì‹œì‘</button>
        </div>

        <div id="quiz-screen" class="game-screen hidden">
            <div id="progress-display">1/10 ë¬¸ì œ</div>
            <h2 id="question-category"></h2>
            <p id="question-text"></p>
            <div id="explanation-text"></div>
            <div id="answer-options-container" class="answer-options-container">
                </div>
            <div id="feedback-message"></div>
            <button id="next-question-btn" class="cute-button hidden">ë‹¤ìŒ ë¬¸ì œ</button>
        </div>

        <div id="result-screen" class="game-screen hidden">
            <h2>ğŸ‰ í€´ì¦ˆ ê²°ê³¼ ğŸ‰</h2>
            <p id="score-display">ì´ 0ê°œ ë§í˜”ì–´ìš”!</p>
            <p id="high-score-display">ìµœê³  ì ìˆ˜: 0ê°œ</p>
            <button id="restart-game-btn" class="cute-button">ë‹¤ì‹œ ì‹œì‘í•˜ê¸°</button>
        </div>
    </div>

    <div id="animation-container"></div>

    <script>
        // CSV ë°ì´í„° íŒŒì‹± ë° ì €ì¥ ë³€ìˆ˜
        let quizData = []; // ì „ì²´ í€´ì¦ˆ ë°ì´í„°ë¥¼ ì €ì¥í•  ë°°ì—´
        let currentQuiz = []; // í˜„ì¬ ê²Œì„ì— ì¶œì œë  10ê°œì˜ ë¬¸ì œë¥¼ ì €ì¥í•  ë°°ì—´
        let currentQuestionIndex = 0; // í˜„ì¬ í’€ê³  ìˆëŠ” ë¬¸ì œì˜ ì¸ë±ìŠ¤
        let score = 0; // í˜„ì¬ ê²Œì„ì˜ ì ìˆ˜
        let selectedCategory = ''; // ì‚¬ìš©ìê°€ ì„ íƒí•œ í€´ì¦ˆ ì¢…ëª©
        let highScore = 0; // ìµœê³  ì ìˆ˜ (ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥)
        let isAnswerChecked = false; // ì •ë‹µ í™•ì¸ ìƒíƒœ í”Œë˜ê·¸

        // ì¹­ì°¬ ë©”ì‹œì§€ ë°°ì—´ (ë‹¤ì–‘í•œ ì¹­ì°¬ ë©”ì‹œì§€ í¬í•¨)
        const positiveFeedback = [
            "ì™€ìš°! ì²œì¬ì¸ê°€ìš”?!",
            "ì •ë‹µì´ì—ìš”! ì •ë§ ëŒ€ë‹¨í•´ìš”!",
            "ì§ì§ì§! ì™„ë²½í•œ ì •ë‹µ!",
            "ìµœê³ ì˜ˆìš”! ì—­ì‹œ ì˜í•˜ëŠ”êµ°ìš”!",
            "ë¹™ê³ ! ì •ë§ ì˜í–ˆì–´ìš”!",
            "í™˜ìƒì ì´ì—ìš”! í€´ì¦ˆ ì™•ì´ ë  ê²ƒ ê°™ì•„ìš”!",
            "ì—„ì²­ë‚˜ìš”! ì´ ë¬¸ì œë¥¼ ë§ì¶”ë‹¤ë‹ˆ!",
            "ëŒ€ë‹¨í•œ ì§‘ì¤‘ë ¥ì´ì—ìš”! ë©‹ì ¸ìš”!",
            "ì •ë§ ë˜‘ë˜‘í•˜ë„¤ìš”! ë‹¤ìŒ ë¬¸ì œë„ ê¸°ëŒ€ë¼ìš”!",
            "ë†€ë¼ì›Œìš”! ë‹¹ì‹ ì˜ ì§€ì‹ì— ë°•ìˆ˜ë¥¼ ë³´ëƒ…ë‹ˆë‹¤!"
        ];

        // ê²©ë ¤ ë©”ì‹œì§€ ë°°ì—´ (ì˜¤ë‹µ ì‹œ ì‚¬ìš©)
        const negativeFeedback = [
            "ê´œì°®ì•„ìš”, ë‹¤ìŒ ë¬¸ì œì—ì„œ ë§ŒíšŒí•  ìˆ˜ ìˆì–´ìš”!",
            "ì¡°ê¸ˆ ì•„ì‰½ì§€ë§Œ, ë‹¤ì‹œ ë„ì „í•´ ë´ìš”!",
            "ì•„í•˜! ë‹¤ìŒì—” ê¼­ ë§ì¶œ ìˆ˜ ìˆì„ ê±°ì˜ˆìš”!",
            "ì‹¤íŒ¨ëŠ” ì„±ê³µì˜ ì–´ë¨¸ë‹ˆ! í˜ë‚´ì„¸ìš”!",
            "ì´ëŸ°! í•˜ì§€ë§Œ ê´œì°®ì•„ìš”, ê³„ì† ë°°ìš°ëŠ” ì¤‘ì´ë‹ˆê¹Œìš”!"
        ];

        // DOM ìš”ì†Œ ê°€ì ¸ì˜¤ê¸°
        const startScreen = document.getElementById('start-screen');
        const quizScreen = document.getElementById('quiz-screen');
        const resultScreen = document.getElementById('result-screen');

        const csvTextInput = document.getElementById('csv-text-input'); // í…ìŠ¤íŠ¸ ì…ë ¥ í•„ë“œ
        const loadTextCsvBtn = document.getElementById('load-text-csv-btn'); // í…ìŠ¤íŠ¸ ë¶ˆëŸ¬ì˜¤ê¸° ë²„íŠ¼
        const csvUrlInput = document.getElementById('csv-url-input'); // URL ì…ë ¥ í•„ë“œ
        const loadUrlCsvBtn = document.getElementById('load-url-csv-btn'); // URL ë¶ˆëŸ¬ì˜¤ê¸° ë²„íŠ¼
        const loadingIndicator = document.getElementById('loading-indicator'); // ë¡œë”© ì¸ë””ì¼€ì´í„°

        const categorySelect = document.getElementById('category-select');
        const startGameBtn = document.getElementById('start-game-btn');

        const progressDisplay = document.getElementById('progress-display');
        const questionCategory = document.getElementById('question-category');
        const questionText = document.getElementById('question-text');
        const answerOptionsContainer = document.getElementById('answer-options-container'); // 4ì§€ì„ ë‹¤ ì»¨í…Œì´ë„ˆ
        const feedbackMessage = document.getElementById('feedback-message');
        const explanationText = document.getElementById('explanation-text');
        const nextQuestionBtn = document.getElementById('next-question-btn');

        const scoreDisplay = document.getElementById('score-display');
        const highScoreDisplay = document.getElementById('high-score-display');
        const restartGameBtn = document.getElementById('restart-game-btn');

        const animationContainer = document.getElementById('animation-container');

        /**
         * ê²Œì„ì„ ì´ˆê¸°í™”í•˜ê³  ì‹œì‘ í™”ë©´ì„ í‘œì‹œí•©ë‹ˆë‹¤.
         * ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ì„œ ìµœê³  ì ìˆ˜ë¥¼ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤.
         */
        function initializeGame() {
            // ëª¨ë“  í™”ë©´ì„ ìˆ¨ê¸°ê³  ì‹œì‘ í™”ë©´ë§Œ í‘œì‹œ
            startScreen.classList.remove('hidden');
            quizScreen.classList.add('hidden');
            resultScreen.classList.add('hidden');

            // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ì„œ ìµœê³  ì ìˆ˜ ë¶ˆëŸ¬ì˜¤ê¸°
            const storedHighScore = localStorage.getItem('familyQuizHighScore');
            if (storedHighScore) {
                highScore = parseInt(storedHighScore, 10);
            }
            highScoreDisplay.textContent = `ìµœê³  ì ìˆ˜: ${highScore}ê°œ`;

            // quizDataê°€ ë¹„ì–´ìˆì„ ë•Œë§Œ CSV ì…ë ¥ ì˜ì—­ì— ì˜ˆì‹œ ë°ì´í„° ë¯¸ë¦¬ ì±„ì›Œë„£ê¸°
            if (quizData.length === 0) {
                csvTextInput.value = `ê°€ì¡±ìƒì‹,ì•„ë¹ ì˜ ë³„ëª…ì€ ë¬´ì—‡ì¼ê¹Œìš”?,ìŠˆí¼ë§¨,ë°°íŠ¸ë§¨,ìŠ¤íŒŒì´ë”ë§¨,ì•„ì´ì–¸ë§¨,ì•„ë¹ ëŠ” ì •ë§ ë©‹ì§„ ì˜ì›…ì´ì…”!
ë™ë¬¼í€´ì¦ˆ,ì½”ë¼ë¦¬ì˜ ì½”ëŠ” ëª‡ ê°œì¼ê¹Œìš”?,1ê°œ,2ê°œ,3ê°œ,4ê°œ,ì½”ë¼ë¦¬ ì½”ëŠ” ê¸¸ê³  í˜ì„¼ í•˜ë‚˜ì˜ ê¸°ê´€ì´ì—ìš”.
ë§Œí™”ìºë¦­í„°,ë½€ë¡œë¡œ ì¹œêµ¬ ì¤‘ ì•ˆê²½ì„ ì“´ ì¹œêµ¬ëŠ”?,ë£¨í”¼,í¬ë¡±,ì—ë””,íŒ¨í‹°,ë£¨í”¼ëŠ” í†µí†µí•œ ëª¸ì— ì•ˆê²½ì„ ì¼ë‹µë‹ˆë‹¤.
ì—­ì‚¬í€´ì¦ˆ,ì„¸ì¢…ëŒ€ì™•ì´ ë§Œë“  ê¸€ìëŠ”?,í•œê¸€,í›ˆë¯¼ì •ìŒ,í•œì,ë¡œë§ˆì,í•œê¸€ì€ ìš°ë¦¬ ë¯¼ì¡±ì˜ ìë‘ìŠ¤ëŸ¬ìš´ ê¸€ìì˜ˆìš”!
ìƒì‹í€´ì¦ˆ,ì§€êµ¬ëŠ” íƒœì–‘ ì£¼ìœ„ë¥¼ ë„ëŠ” í–‰ì„±ì…ë‹ˆë‹¤. ë§ì„ê¹Œìš”?,O,X,ì„¸ëª¨,ë„¤ëª¨,ì§€êµ¬ëŠ” íƒœì–‘ê³„ì˜ ì„¸ ë²ˆì§¸ í–‰ì„±ì´ì—ìš”.
ìŒì‹í€´ì¦ˆ,ê¹€ì¹˜ì°Œê°œì˜ ì£¼ì¬ë£ŒëŠ” ë¬´ì—‡ì¼ê¹Œìš”?,ê¹€ì¹˜,ë‘ë¶€,ë¼ì§€ê³ ê¸°,íŒŒ,ê¹€ì¹˜ëŠ” í•œêµ­ì˜ ëŒ€í‘œì ì¸ ë°œíš¨ ìŒì‹ì´ì—ìš”.
ìŠ¤í¬ì¸ í€´ì¦ˆ,ì¶•êµ¬ì—ì„œ í•œ íŒ€ì˜ ì„ ìˆ˜ëŠ” ëª‡ ëª…ì¼ê¹Œìš”?,11ëª…,9ëª…,10ëª…,12ëª…,ê³¨í‚¤í¼ë¥¼ í¬í•¨í•´ì„œ 11ëª…ì´ í•œ íŒ€ì„ ì´ë¤„ìš”.
ê³¼í•™í€´ì¦ˆ,ë¬¼ì€ ëª‡ ë„ì—ì„œ ì–¼ê¹Œìš”?,0ë„,100ë„,-10ë„,5ë„,ë¬¼ì˜ ì–´ëŠ”ì ì€ 0ë„ì”¨ì…ë‹ˆë‹¤.
ì§€ë¦¬í€´ì¦ˆ,ëŒ€í•œë¯¼êµ­ì˜ ìˆ˜ë„ëŠ” ì–´ë””ì¼ê¹Œìš”?,ì„œìš¸,ë¶€ì‚°,ì œì£¼,ë„ì¿„,ì„œìš¸ì€ ëŒ€í•œë¯¼êµ­ì˜ ê°€ì¥ í° ë„ì‹œì˜ˆìš”.
ë™í™”í€´ì¦ˆ,ë°±ì„¤ê³µì£¼ì— ë‚˜ì˜¤ëŠ” ë‚œìŸì´ëŠ” ëª¨ë‘ ëª‡ ëª…ì¼ê¹Œìš”?,7ëª…,5ëª…,6ëª…,8ëª…,ì¼ê³± ë‚œìŸì´ì™€ í•¨ê»˜ ì‚´ì•˜ì–´ìš”.
ê°€ì¡±ìƒì‹,ì—„ë§ˆê°€ ê°€ì¥ ì¢‹ì•„í•˜ëŠ” ê½ƒì€ ë¬´ì—‡ì¼ê¹Œìš”?,ì¥ë¯¸,íŠ¤ë¦½,í•´ë°”ë¼ê¸°,ë°±í•©,ì¥ë¯¸ëŠ” ì•„ë¦„ë‹¤ìš´ ê½ƒì˜ ì—¬ì™•ì´ì—ìš”.
ë™ë¬¼í€´ì¦ˆ,í•˜ëŠ˜ì„ ë‚  ìˆ˜ ì—†ëŠ” ìƒˆëŠ” ë¬´ì—‡ì¼ê¹Œìš”?,í­ê·„,ì°¸ìƒˆ,ë…ìˆ˜ë¦¬,ë¹„ë‘˜ê¸°,í­ê·„ì€ ë‚ ì§€ ëª»í•˜ì§€ë§Œ ìˆ˜ì˜ì„ ì•„ì£¼ ì˜í•´ìš”.
ë§Œí™”ìºë¦­í„°,ê²¨ìš¸ì™•êµ­ì—ì„œ ì—˜ì‚¬ì˜ ë™ìƒ ì´ë¦„ì€?,ì•ˆë‚˜,ì˜¬ë¼í”„,í¬ë¦¬ìŠ¤í† í”„,í•œìŠ¤,ì•ˆë‚˜ëŠ” ì—˜ì‚¬ì˜ ì‚¬ë‘ìŠ¤ëŸ¬ìš´ ì—¬ë™ìƒì´ì—ìš”.
ì—­ì‚¬í€´ì¦ˆ,ì´ìˆœì‹  ì¥êµ°ì´ í™œì•½í–ˆë˜ ì „ìŸì€?,ì„ì§„ì™œë€,ë³‘ìí˜¸ë€,í•œêµ­ì „ìŸ,ì„ë¯¸ì‚¬ë³€,ì„ì§„ì™œë€ì€ ì¡°ì„  ì‹œëŒ€ì— ì¼ì–´ë‚œ í° ì „ìŸì´ì—ìš”.
ìƒì‹í€´ì¦ˆ,ì‚¬ê³¼ê°€ ë‚˜ë¬´ì—ì„œ ë–¨ì–´ì§€ëŠ” í˜„ìƒì„ ì„¤ëª…í•˜ëŠ” ë²•ì¹™ì€?,ë§Œìœ ì¸ë ¥ì˜ ë²•ì¹™,ì‘ìš© ë°˜ì‘ìš©ì˜ ë²•ì¹™,ê´€ì„±ì˜ ë²•ì¹™,ì§ˆëŸ‰ ë³´ì¡´ì˜ ë²•ì¹™,ë‰´í„´ì´ ë°œê²¬í•œ ì¤‘ìš”í•œ ë²•ì¹™ì´ì—ìš”.
ìŒì‹í€´ì¦ˆ,ì§œì¥ë©´ì€ ì–´ëŠ ë‚˜ë¼ ìŒì‹ì¼ê¹Œìš”?,ì¤‘êµ­,í•œêµ­,ì¼ë³¸,ë¯¸êµ­,ì¤‘êµ­ì—ì„œ ìœ ë˜í•œ ë©´ ìš”ë¦¬ì…ë‹ˆë‹¤.
ìŠ¤í¬ì¸ í€´ì¦ˆ,ë†êµ¬ì—ì„œ ê³¨ì„ ë„£ìœ¼ë©´ ëª‡ ì ì¼ê¹Œìš”?,2ì ,1ì ,3ì ,4ì ,ììœ íˆ¬ëŠ” 1ì , 3ì  ë¼ì¸ ë°–ì€ 3ì ì´ì—ìš”.
ê³¼í•™í€´ì¦ˆ,ì‚¬ëŒì˜ ëª¸ì—ì„œ ê°€ì¥ í° ì¥ê¸°ëŠ”?,í”¼ë¶€,ê°„,ë‡Œ,ì‹¬ì¥,í”¼ë¶€ëŠ” ìš°ë¦¬ ëª¸ì„ ë³´í˜¸í•˜ëŠ” ê°€ì¥ í° ê¸°ê´€ì´ì—ìš”.
ì§€ë¦¬í€´ì¦ˆ,ì„¸ê³„ì—ì„œ ê°€ì¥ ë†’ì€ ì‚°ì€?,ì—ë² ë ˆìŠ¤íŠ¸,ë°±ë‘ì‚°,í•œë¼ì‚°,í›„ì§€ì‚°,ì—ë² ë ˆìŠ¤íŠ¸ëŠ” íˆë§ë¼ì•¼ ì‚°ë§¥ì— ìˆì–´ìš”.
ë™í™”í€´ì¦ˆ,ì‹ ë°ë ë¼ê°€ ë¬´ë„íšŒì— ê°ˆ ë•Œ íƒ€ê³  ê°„ ê²ƒì€?,í˜¸ë°•ë§ˆì°¨,ìë™ì°¨,ë¹„í–‰ê¸°,ê¸°ì°¨,ë§ˆë²•ìœ¼ë¡œ ë³€í•œ í˜¸ë°•ë§ˆì°¨ë¥¼ íƒ€ê³  ê°”ì–´ìš”.`;
            }
            // í˜„ì¬ quizDataë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë“œë¡­ë‹¤ìš´ ì—…ë°ì´íŠ¸ (ì´ˆê¸° ë¡œë“œ ë˜ëŠ” ê²Œì„ ì¬ì‹œì‘ ì‹œ)
            updateCategoryDropdown();
        }

        /**
         * CSV ë¬¸ìì—´ì„ íŒŒì‹±í•˜ì—¬ í€´ì¦ˆ ë°ì´í„° ë°°ì—´ë¡œ ë³€í™˜í•˜ëŠ” í—¬í¼ í•¨ìˆ˜ì…ë‹ˆë‹¤.
         * CSV í˜•ì‹: [ë¬¸ì œ ì¢…ëª©], [ë¬¸ì œ], [ì •ë‹µ], [ì˜¤ë‹µ1], [ì˜¤ë‹µ2], [ì˜¤ë‹µ3], [ì˜¤ë‹µ ì‹œ ê°„ëµ ì„¤ëª…]
         * @param {string} csvString - CSV í˜•ì‹ì˜ ë¬¸ìì—´.
         * @returns {Array<Object>} íŒŒì‹±ëœ í€´ì¦ˆ ë°ì´í„° ë°°ì—´.
         */
        function parseCsvString(csvString) {
            const lines = csvString.trim().split('\n');
            const parsedData = [];
            for (const line of lines) {
                // ê° ì¤„ì„ ì‰¼í‘œë¡œ ë¶„ë¦¬
                const parts = line.split(',');
                // ì •í™•íˆ 7ê°œì˜ ìš”ì†Œê°€ ìˆëŠ”ì§€ í™•ì¸
                if (parts.length === 7) {
                    parsedData.push({
                        category: parts[0].trim(), // ë¬¸ì œ ì¢…ëª©
                        question: parts[1].trim(), // ë¬¸ì œ
                        correctAnswer: parts[2].trim(), // ì •ë‹µ
                        incorrect1: parts[3].trim(), // ì˜¤ë‹µ1
                        incorrect2: parts[4].trim(), // ì˜¤ë‹µ2
                        incorrect3: parts[5].trim(), // ì˜¤ë‹µ3
                        explanation: parts[6].trim() // ì˜¤ë‹µ ì‹œ ê°„ëµ ì„¤ëª…
                    });
                } else {
                    console.warn('ì˜ëª»ëœ CSV ë°ì´í„° í˜•ì‹ (7ê°œ ì—´ì´ í•„ìš”í•©ë‹ˆë‹¤):', line);
                }
            }
            return parsedData;
        }

        /**
         * CSV í…ìŠ¤íŠ¸ ì…ë ¥ í•„ë“œì—ì„œ ë°ì´í„°ë¥¼ íŒŒì‹±í•˜ì—¬ í€´ì¦ˆ ë°ì´í„°ë¥¼ ë¡œë“œí•©ë‹ˆë‹¤.
         */
        function loadCsvFromText() {
            const csvString = csvTextInput.value;
            const newQuizData = parseCsvString(csvString);
            if (newQuizData.length > 0) {
                quizData = newQuizData;
                updateCategoryDropdown();
                alertMessage("í…ìŠ¤íŠ¸ ë°ì´í„°ê°€ ì„±ê³µì ìœ¼ë¡œ ë¶ˆëŸ¬ì™€ì¡ŒìŠµë‹ˆë‹¤!");
            } else {
                alertMessage("í…ìŠ¤íŠ¸ ë°ì´í„°ê°€ ì—†ê±°ë‚˜ í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.");
            }
        }

        /**
         * Google ìŠ¤í”„ë ˆë“œì‹œíŠ¸ ê³µê°œ CSV URLì—ì„œ ë°ì´í„°ë¥¼ ë¹„ë™ê¸°ì ìœ¼ë¡œ ë¡œë“œí•©ë‹ˆë‹¤.
         */
        async function loadCsvFromUrl() {
            const url = csvUrlInput.value.trim();
            if (!url) {
                alertMessage("CSV URLì„ ì…ë ¥í•´ì£¼ì„¸ìš”!");
                return;
            }

            loadingIndicator.style.display = 'block'; // ë¡œë”© ì¸ë””ì¼€ì´í„° í‘œì‹œ
            try {
                const response = await fetch(url);
                if (!response.ok) {
                    throw new Error(`HTTP ì˜¤ë¥˜! ìƒíƒœ: ${response.status}`);
                }
                const csvString = await response.text();
                const newQuizData = parseCsvString(csvString);

                if (newQuizData.length > 0) {
                    quizData = newQuizData;
                    updateCategoryDropdown();
                    alertMessage("URLì—ì„œ ë°ì´í„°ê°€ ì„±ê³µì ìœ¼ë¡œ ë¶ˆëŸ¬ì™€ì¡ŒìŠµë‹ˆë‹¤!");
                } else {
                    alertMessage("URLì—ì„œ ìœ íš¨í•œ í€´ì¦ˆ ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. í˜•ì‹ì„ í™•ì¸í•´ì£¼ì„¸ìš”.");
                }
            } catch (error) {
                console.error('URLì—ì„œ CSV ë¶ˆëŸ¬ì˜¤ê¸° ì˜¤ë¥˜:', error);
                alertMessage(`ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ${error.message}. URLì´ ì˜¬ë°”ë¥¸ì§€, ì›¹ì— ê²Œì‹œë˜ì—ˆëŠ”ì§€ í™•ì¸í•´ì£¼ì„¸ìš” (CORS ë¬¸ì œì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤).`);
            } finally {
                loadingIndicator.style.display = 'none'; // ë¡œë”© ì¸ë””ì¼€ì´í„° ìˆ¨ê¹€
            }
        }

        /**
         * íŒŒì‹±ëœ í€´ì¦ˆ ë°ì´í„°ì—ì„œ ê³ ìœ í•œ ì¢…ëª©ë“¤ì„ ì¶”ì¶œí•˜ì—¬ ë“œë¡­ë‹¤ìš´ ë©”ë‰´ë¥¼ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.
         */
        function updateCategoryDropdown() {
            // ê¸°ì¡´ ì˜µì…˜ ì œê±° (ì²« ë²ˆì§¸ "-- ì¢…ëª© ì„ íƒ --" ì˜µì…˜ ì œì™¸)
            while (categorySelect.options.length > 1) {
                categorySelect.remove(1);
            }

            const categories = new Set(); // ì¤‘ë³µì„ ì œê±°í•˜ê¸° ìœ„í•œ Set
            quizData.forEach(item => {
                categories.add(item.category);
            });

            // Setì— ìˆëŠ” ê° ì¢…ëª©ì„ ë“œë¡­ë‹¤ìš´ ì˜µì…˜ìœ¼ë¡œ ì¶”ê°€
            categories.forEach(category => {
                const option = document.createElement('option');
                option.value = category;
                option.textContent = category;
                categorySelect.appendChild(option);
            });
        }

        /**
         * ì„ íƒëœ ì¢…ëª©ì— ë”°ë¼ í€´ì¦ˆë¥¼ ì‹œì‘í•©ë‹ˆë‹¤.
         * 10ê°œì˜ ë¬¸ì œë¥¼ ëœë¤ìœ¼ë¡œ ì„ íƒí•˜ê³  ê²Œì„ ìƒíƒœë¥¼ ì´ˆê¸°í™”í•©ë‹ˆë‹¤.
         */
        function startGame() {
            selectedCategory = categorySelect.value;
            if (!selectedCategory) {
                alertMessage("í€´ì¦ˆ ì¢…ëª©ì„ ì„ íƒí•´ì£¼ì„¸ìš”!");
                return;
            }

            // ì„ íƒëœ ì¢…ëª©ì˜ ë¬¸ì œë§Œ í•„í„°ë§
            const filteredQuestions = quizData.filter(q => q.category === selectedCategory);
            if (filteredQuestions.length < 10) {
                alertMessage(`ì„ íƒëœ ì¢…ëª© (${selectedCategory})ì— 10ë¬¸ì œ ë¯¸ë§Œì…ë‹ˆë‹¤. ìµœì†Œ 10ë¬¸ì œê°€ í•„ìš”í•©ë‹ˆë‹¤.`);
                return;
            }

            // í•„í„°ë§ëœ ë¬¸ì œë“¤ì„ ì„ê³  10ê°œë§Œ ì„ íƒ (ì¤‘ë³µ ë°©ì§€)
            const shuffled = [...filteredQuestions].sort(() => 0.5 - Math.random());
            currentQuiz = shuffled.slice(0, 10);

            // ê²Œì„ ìƒíƒœ ì´ˆê¸°í™”
            currentQuestionIndex = 0;
            score = 0;
            isAnswerChecked = false; // ì •ë‹µ í™•ì¸ ìƒíƒœ ì´ˆê¸°í™”

            // í™”ë©´ ì „í™˜
            startScreen.classList.add('hidden');
            quizScreen.classList.remove('hidden');

            displayQuestion(); // ì²« ë²ˆì§¸ ë¬¸ì œ í‘œì‹œ
        }

        /**
         * í˜„ì¬ ë¬¸ì œë¥¼ í™”ë©´ì— í‘œì‹œí•©ë‹ˆë‹¤.
         */
        function displayQuestion() {
            // ì´ì „ í”¼ë“œë°± ë° ì„¤ëª… ìˆ¨ê¸°ê¸°
            feedbackMessage.textContent = '';
            feedbackMessage.className = ''; // í´ë˜ìŠ¤ ì œê±°
            explanationText.textContent = ''; // ì„¤ëª… í…ìŠ¤íŠ¸ ì´ˆê¸°í™”
            nextQuestionBtn.classList.add('hidden'); // ë‹¤ìŒ ë¬¸ì œ ë²„íŠ¼ ìˆ¨ê¸°ê¸°
            isAnswerChecked = false; // ì •ë‹µ í™•ì¸ ìƒíƒœ ì´ˆê¸°í™”

            // 4ì§€ì„ ë‹¤ ì„ íƒì§€ ì»¨í…Œì´ë„ˆ ì´ˆê¸°í™”
            answerOptionsContainer.innerHTML = '';

            // í˜„ì¬ ë¬¸ì œ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
            const question = currentQuiz[currentQuestionIndex];
            if (question) {
                progressDisplay.textContent = `${currentQuestionIndex + 1}/10 ë¬¸ì œ`;
                questionCategory.textContent = `[${question.category}]`;
                questionText.textContent = question.question;

                // ì •ë‹µê³¼ ì˜¤ë‹µë“¤ì„ ë°°ì—´ë¡œ í•©ì¹˜ê³  ì„ê¸°
                const answers = [
                    question.correctAnswer,
                    question.incorrect1,
                    question.incorrect2,
                    question.incorrect3
                ];
                // ë°°ì—´ ì„ê¸° (Fisher-Yates shuffle ì•Œê³ ë¦¬ì¦˜)
                for (let i = answers.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [answers[i], answers[j]] = [answers[j], answers[i]]; // ë°°ì—´ ìš”ì†Œ êµí™˜
                }

                // ì„ì¸ ë‹µë³€ë“¤ì„ ë²„íŠ¼ìœ¼ë¡œ ìƒì„±
                answers.forEach(answer => {
                    const button = document.createElement('button');
                    button.classList.add('answer-option-button');
                    button.textContent = answer;
                    button.addEventListener('click', () => checkAnswer(button, question.correctAnswer));
                    answerOptionsContainer.appendChild(button);
                });

            } else {
                // ë¬¸ì œê°€ ì—†ìœ¼ë©´ ê²°ê³¼ í™”ë©´ìœ¼ë¡œ ì´ë™ (ì˜ˆì™¸ ì²˜ë¦¬)
                showResultScreen();
            }
        }

        /**
         * ì‚¬ìš©ìì˜ ì •ë‹µì„ í™•ì¸í•˜ê³  í”¼ë“œë°±ì„ ì œê³µí•©ë‹ˆë‹¤.
         * @param {HTMLButtonElement} clickedButton - ì‚¬ìš©ìê°€ í´ë¦­í•œ ë‹µë³€ ë²„íŠ¼ ìš”ì†Œ.
         * @param {string} correctAnswerText - í˜„ì¬ ë¬¸ì œì˜ ì‹¤ì œ ì •ë‹µ í…ìŠ¤íŠ¸.
         */
        function checkAnswer(clickedButton, correctAnswerText) {
            if (isAnswerChecked) return; // ì´ë¯¸ ì •ë‹µì„ í™•ì¸í–ˆìœ¼ë©´ ë‹¤ì‹œ ì²˜ë¦¬í•˜ì§€ ì•ŠìŒ
            isAnswerChecked = true; // ì •ë‹µ í™•ì¸ ìƒíƒœë¡œ ë³€ê²½

            const userAnswer = clickedButton.textContent.trim(); // í´ë¦­ëœ ë²„íŠ¼ì˜ í…ìŠ¤íŠ¸
            const allAnswerButtons = answerOptionsContainer.querySelectorAll('.answer-option-button');

            // ëª¨ë“  ë‹µë³€ ë²„íŠ¼ ë¹„í™œì„±í™”
            allAnswerButtons.forEach(button => {
                button.classList.add('disabled');
            });

            if (userAnswer === correctAnswerText) {
                // ì •ë‹µì¼ ê²½ìš°
                score++; // ì ìˆ˜ ì¦ê°€
                feedbackMessage.textContent = positiveFeedback[Math.floor(Math.random() * positiveFeedback.length)];
                feedbackMessage.classList.add('correct-feedback');
                clickedButton.classList.add('correct'); // ì •ë‹µ ë²„íŠ¼ ìƒ‰ìƒ ë³€ê²½
                triggerConfettiAnimation(); // í­ì£½ ì• ë‹ˆë©”ì´ì…˜

                // ê¸ì •ì ì¸ í”¼ë“œë°± í›„ ì ì‹œ ëŒ€ê¸° í›„ ë‹¤ìŒ ë¬¸ì œë¡œ ì´ë™
                setTimeout(() => {
                    nextQuestion();
                }, 1500); // 1.5ì´ˆ í›„ ë‹¤ìŒ ë¬¸ì œë¡œ
            } else {
                // ì˜¤ë‹µì¼ ê²½ìš°
                feedbackMessage.textContent = negativeFeedback[Math.floor(Math.random() * negativeFeedback.length)];
                feedbackMessage.classList.add('incorrect-feedback');
                clickedButton.classList.add('incorrect'); // ì˜¤ë‹µ ë²„íŠ¼ ìƒ‰ìƒ ë³€ê²½

                // ì •ë‹µ ë²„íŠ¼ì„ ì°¾ì•„ì„œ í‘œì‹œ
                allAnswerButtons.forEach(button => {
                    if (button.textContent.trim() === correctAnswerText) {
                        button.classList.add('correct');
                    }
                });

                explanationText.textContent = `ì •ë‹µì€ "${currentQuiz[currentQuestionIndex].correctAnswer}" ì´ì—ˆì–´ìš”. (${currentQuiz[currentQuestionIndex].explanation})`;
                nextQuestionBtn.classList.remove('hidden'); // ë‹¤ìŒ ë¬¸ì œ ë²„íŠ¼ í‘œì‹œ
            }
        }

        /**
         * ë‹¤ìŒ ë¬¸ì œë¡œ ì´ë™í•˜ê±°ë‚˜, ëª¨ë“  ë¬¸ì œê°€ ëë‚¬ìœ¼ë©´ ê²°ê³¼ í™”ë©´ì„ í‘œì‹œí•©ë‹ˆë‹¤.
         */
        function nextQuestion() {
            currentQuestionIndex++;
            if (currentQuestionIndex < currentQuiz.length) {
                displayQuestion(); // ë‹¤ìŒ ë¬¸ì œ í‘œì‹œ
            } else {
                showResultScreen(); // ëª¨ë“  ë¬¸ì œ ì™„ë£Œ, ê²°ê³¼ í™”ë©´ í‘œì‹œ
            }
        }

        /**
         * ê²Œì„ ê²°ê³¼ í™”ë©´ì„ í‘œì‹œí•˜ê³  ìµœê³  ì ìˆ˜ë¥¼ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.
         */
        function showResultScreen() {
            quizScreen.classList.add('hidden');
            resultScreen.classList.remove('hidden');

            scoreDisplay.textContent = `ì´ ${score}ê°œ ë§í˜”ì–´ìš”!`;

            // ìµœê³  ì ìˆ˜ ì—…ë°ì´íŠ¸ ë° ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ì €ì¥
            if (score > highScore) {
                highScore = score;
                localStorage.setItem('familyQuizHighScore', highScore);
                highScoreDisplay.textContent = `ìµœê³  ì ìˆ˜: ${highScore}ê°œ (ìƒˆë¡œìš´ ê¸°ë¡!)`;
            } else {
                highScoreDisplay.textContent = `ìµœê³  ì ìˆ˜: ${highScore}ê°œ`;
            }
        }

        /**
         * ì‚¬ìš©ìì—ê²Œ ë©”ì‹œì§€ë¥¼ í‘œì‹œí•˜ëŠ” ì»¤ìŠ¤í…€ ì•Œë¦¼ í•¨ìˆ˜.
         * (ë¸Œë¼ìš°ì €ì˜ alert() ëŒ€ì‹  ì‚¬ìš©)
         */
        function alertMessage(message) {
            const messageBox = document.createElement('div');
            messageBox.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background-color: #FFEB3B; /* ë…¸ë€ìƒ‰ ë°°ê²½ */
                color: #333;
                padding: 20px 30px;
                border-radius: 15px;
                box-shadow: 0 5px 15px rgba(0,0,0,0.3);
                font-size: 1.2em;
                font-weight: bold;
                z-index: 1000;
                animation: fadeInOut 2s forwards; /* ë‚˜íƒ€ë‚¬ë‹¤ ì‚¬ë¼ì§€ëŠ” ì• ë‹ˆë©”ì´ì…˜ */
            `;
            messageBox.textContent = message;
            document.body.appendChild(messageBox);

            // ì• ë‹ˆë©”ì´ì…˜ í‚¤í”„ë ˆì„ ì¶”ê°€ (CSSì— ì´ë¯¸ ì •ì˜ë˜ì–´ ìˆì§€ ì•Šë‹¤ë©´)
            if (!document.getElementById('fadeInOutKeyframes')) {
                const style = document.createElement('style');
                style.id = 'fadeInOutKeyframes';
                style.innerHTML = `
                    @keyframes fadeInOut {
                        0% { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
                        20% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
                        80% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
                        100% { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
                    }
                `;
                document.head.appendChild(style);
            }

            setTimeout(() => {
                messageBox.remove();
            }, 2000); // 2ì´ˆ í›„ ë©”ì‹œì§€ ë°•ìŠ¤ ì œê±°
        }

        /**
         * ì •ë‹µ ì‹œ í­ì£½/ë°˜ì§ì´ ì• ë‹ˆë©”ì´ì…˜ì„ ìƒì„±í•©ë‹ˆë‹¤.
         */
        function triggerConfettiAnimation() {
            const numParticles = 30;
            const colors = ['#FFD700', '#FF6347', '#6A5ACD', '#00CED1', '#ADFF2F']; // ë‹¤ì–‘í•œ ìƒ‰ìƒ

            for (let i = 0; i < numParticles; i++) {
                const particle = document.createElement('div');
                particle.classList.add('particle');
                const size = Math.random() * 8 + 4; // 4px ~ 12px
                particle.style.width = `${size}px`;
                particle.style.height = `${size}px`;
                particle.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];

                // íŒŒí‹°í´ ì‹œì‘ ìœ„ì¹˜ (ì •ë‹µ ë©”ì‹œì§€ ì£¼ë³€)
                const rect = feedbackMessage.getBoundingClientRect();
                particle.style.left = `${rect.left + rect.width / 2 + (Math.random() - 0.5) * 50}px`;
                particle.style.top = `${rect.top + rect.height / 2 + (Math.random() - 0.5) * 50}px`;

                // ì• ë‹ˆë©”ì´ì…˜ ì„¤ì •
                const duration = Math.random() * 0.8 + 0.7; // 0.7s ~ 1.5s
                const delay = Math.random() * 0.2; // 0s ~ 0.2s
                const translateX = (Math.random() - 0.5) * 200; // -100px ~ 100px
                const translateY = (Math.random() - 0.5) * 200 - 50; // -150px ~ 50px (ìœ„ë¡œ ë” ë§ì´)

                particle.style.animation = `particle-fade-out ${duration}s forwards`;
                particle.style.animationDelay = `${delay}s`;
                particle.style.transform = `translate(${translateX}px, ${translateY}px)`; // ì´ˆê¸° ì´ë™

                animationContainer.appendChild(particle);

                // ì• ë‹ˆë©”ì´ì…˜ ì¢…ë£Œ í›„ íŒŒí‹°í´ ì œê±°
                particle.addEventListener('animationend', () => {
                    particle.remove();
                });
            }
        }


        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
        document.addEventListener('DOMContentLoaded', initializeGame); // DOM ë¡œë“œ ì™„ë£Œ ì‹œ ê²Œì„ ì´ˆê¸°í™”

        loadTextCsvBtn.addEventListener('click', loadCsvFromText); // í…ìŠ¤íŠ¸ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° ë²„íŠ¼ í´ë¦­ ì‹œ CSV íŒŒì‹±
        loadUrlCsvBtn.addEventListener('click', loadCsvFromUrl); // URL ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° ë²„íŠ¼ í´ë¦­ ì‹œ URLì—ì„œ CSV ë¡œë“œ

        startGameBtn.addEventListener('click', startGame); // ê²Œì„ ì‹œì‘ ë²„íŠ¼ í´ë¦­ ì‹œ ê²Œì„ ì‹œì‘

        nextQuestionBtn.addEventListener('click', nextQuestion); // ë‹¤ìŒ ë¬¸ì œ ë²„íŠ¼ í´ë¦­ ì‹œ ë‹¤ìŒ ë¬¸ì œë¡œ ì´ë™

        restartGameBtn.addEventListener('click', initializeGame); // ë‹¤ì‹œ ì‹œì‘í•˜ê¸° ë²„íŠ¼ í´ë¦­ ì‹œ ê²Œì„ ì´ˆê¸°í™”

        // í…ìŠ¤íŠ¸ ì…ë ¥ í•„ë“œ ëŒ€ì‹  ë²„íŠ¼ í´ë¦­ìœ¼ë¡œ ì •ë‹µ í™•ì¸
        // answerInput.addEventListener('keypress', (event) => { ... }); // ì´ ë¶€ë¶„ì€ ì´ì œ í•„ìš” ì—†ìŠµë‹ˆë‹¤.
    </script>
</body>
</html>

